<?xml version="1.0" encoding="UTF-8"?>
<gtr:projectOverview xmlns:gtr="http://gtr.ukri.org/api"><gtr:projectComposition><gtr:collaborations/><gtr:leadResearchOrganisation url="http://gtr.ukri.org:80/organisation/2DB7ED73-8E89-457A-A395-FAC12F929C1A"><gtr:id>2DB7ED73-8E89-457A-A395-FAC12F929C1A</gtr:id><gtr:name>University of Edinburgh</gtr:name><gtr:department>Edinburgh Parallel Computing Centre</gtr:department><gtr:address><gtr:line1>Old College</gtr:line1><gtr:line2>South Bridge</gtr:line2><gtr:line3>Mayfield Road</gtr:line3><gtr:line4>Edinburgh</gtr:line4><gtr:postCode>EH8 9YL</gtr:postCode><gtr:region>Scotland</gtr:region><gtr:country>United Kingdom</gtr:country></gtr:address><gtr:typeInd>RO</gtr:typeInd></gtr:leadResearchOrganisation><gtr:organisationRoles><gtr:organisationRole url="http://gtr.ukri.org:80/organisation/2DB7ED73-8E89-457A-A395-FAC12F929C1A"><gtr:id>2DB7ED73-8E89-457A-A395-FAC12F929C1A</gtr:id><gtr:name>University of Edinburgh</gtr:name><gtr:address><gtr:line1>Old College</gtr:line1><gtr:line2>South Bridge</gtr:line2><gtr:line3>Mayfield Road</gtr:line3><gtr:line4>Edinburgh</gtr:line4><gtr:postCode>EH8 9YL</gtr:postCode><gtr:region>Scotland</gtr:region><gtr:country>United Kingdom</gtr:country></gtr:address><gtr:roles><gtr:role><gtr:name>LEAD_RO</gtr:name></gtr:role></gtr:roles></gtr:organisationRole></gtr:organisationRoles><gtr:personRoles><gtr:personRole url="http://gtr.ukri.org:80/person/14B5B722-33FA-4729-B8F4-163935B890D1"><gtr:id>14B5B722-33FA-4729-B8F4-163935B890D1</gtr:id><gtr:firstName>Joachim</gtr:firstName><gtr:surname>Hein</gtr:surname><gtr:roles><gtr:role><gtr:name>PRINCIPAL_INVESTIGATOR</gtr:name></gtr:role></gtr:roles></gtr:personRole></gtr:personRoles><gtr:project url="http://gtr.ukri.org:80/projects?ref=EP%2FH00212X%2F1"><gtr:id>D6D650F3-D3BC-41DF-87DB-A9F3B77A5B9B</gtr:id><gtr:title>Multiscale Modelling of Magnetised Plasma Turbulence</gtr:title><gtr:status>Closed</gtr:status><gtr:grantCategory>Research Grant</gtr:grantCategory><gtr:grantReference>EP/H00212X/1</gtr:grantReference><gtr:abstractText>Heisenberg reputedly said on his death bed, When I meet God, I am going to ask him two questions: Why relativity? And why turbulence? I really believe he will have an answer for the first. Understanding turbulence remains a fundamental open question in physics that is nowadays accessible to high performance computing (HPC).Plasma (ionised gas) is the fourth state of matter that dominates our observable universe, and burns in stars through nuclear fusion reactions to produce energy and the elements. Laboratory experiments replicate these processes, aiming to harness terrestrial nuclear fusion for energy, and an advanced approach exploits toroidal magnetic fields to confine hot plasma at temperatures &amp;gt;100 million K. Fusion requires good confinement, and this is limited by collisions and plasma turbulence. Collisional processes cause an irreducible minimum plasma loss rate that is understood theoretically, but larger losses, due to turbulent processes, are observed in devices. Recent experiments find dramatically enhanced confinement regimes with higher core pressures, where losses are strongly reduced in localised regions of plasma, approximately to the level predicted by collisional theory. In the region of the internal transport barrier (ITB), turbulence is strongly suppressed. There is much scope for optimising fusion devices through controlling turbulence.Calculations of magnetised plasma turbulence parallelise efficiently, and recent advances in HPC permit high fidelity first principles based calculations. HPC is essential because of the high dimensionality of the problem (5-D in kinetic approaches) and the huge ranges of scales of the physics processes in space and time. This proposal is for scientists at UKAEA Culham, Edinburgh, Oxford, Warwick and York to exploit the EPSRC national supercomputer HECToR to perform magnetised plasma turbulence simulations using state-of-the-art kinetic and fluid models. Multiscale simulations, ideally suited to HECToR, will resolve fundamental plasma processes that span in space from the short length scale associated with particle gyration around the magnetic field (eg the ion Larmor radius rho_i ~O(5)mm) to the device minor radius a (~O(1)m), and in time from the lifetime of turbulent eddies (~O(10^-6)s) to the energy confinement time (~O(1s)). We will approach our objectives using complementary models: (i) coupling multiple local kinetic turbulence simulations self-consistently with a transport solver to track the slower evolution of macroscopic plasma properties, (ii) global kinetic simulations and (iii) applying the two-fluid-MHD plasma model to describe turbulence at scales between rho_i and a. The key scientific issues to be explored include: (1) probing the fundamental triggers for the suppression of turbulence and the onset of transport barriers(2) assessing the relative importance of turbulent fluctuations on different length scales, and probing the cascade of turbulent energy between these scales(3) comparing model predictions with experiments (including spherical tokamaks like the UK experiment MAST), and suggesting routes to optimise plasma performance in future devices (eg the next step burning plasma experiment ITER).This internationally leading project team is well placed to make unique contributions towards addressing these important and challenging scientific questions. Our proposed simulations will parallelise to exploit 1000s of computational cores efficiently, and indeed require access to a state of the art supercomputer like HECToR. The science tackled is relevant to fusion and astrophysics. Success in achieving these ambitious scientific objectives will address long standing grand challenges, and will have a high international impact.</gtr:abstractText><gtr:fund><gtr:end>2013-05-31</gtr:end><gtr:funder url="http://gtr.ukri.org:80/organisation/798CB33D-C79E-4578-83F2-72606407192C"><gtr:id>798CB33D-C79E-4578-83F2-72606407192C</gtr:id><gtr:name>EPSRC</gtr:name></gtr:funder><gtr:start>2009-06-01</gtr:start><gtr:type>INCOME_ACTUAL</gtr:type><gtr:valuePounds>37288</gtr:valuePounds></gtr:fund><gtr:output><gtr:artisticAndCreativeProductOutputs/><gtr:collaborationOutputs/><gtr:disseminationOutputs/><gtr:exploitationOutputs/><gtr:furtherFundingOutputs><gtr:furtherFundingOutput><gtr:amountPounds>57997</gtr:amountPounds><gtr:country>United Kingdom of Great Britain &amp; Northern Ireland (UK)</gtr:country><gtr:currCode>GBP</gtr:currCode><gtr:currCountryCode>United Kingdom</gtr:currCountryCode><gtr:currLang>en_GB</gtr:currLang><gtr:department>High-End Computing Terascale Resource (HECToR)</gtr:department><gtr:description>HECToR Distributed CSE Support</gtr:description><gtr:end>2012-01-02</gtr:end><gtr:fundingOrg>University of Edinburgh</gtr:fundingOrg><gtr:id>D630AE3D-E91D-41D4-B93F-7BCA1602DE83</gtr:id><gtr:outcomeId>5ebc499c5ebc49b0</gtr:outcomeId><gtr:sector>Academic/University</gtr:sector><gtr:start>2011-03-01</gtr:start></gtr:furtherFundingOutput></gtr:furtherFundingOutputs><gtr:impactSummaryOutputs><gtr:impactSummaryOutput><gtr:description>This project formed part of a bigger project consisting out of three linked project proposals, with the aim of investigating turbulence in magnetised fusion plasmas. The focus of the here described project was on the high performance computing (HPC) related aspects of the overall project.

As discussed in the key findings, the project was instrumental in gaining a better understanding of the performance obstacles of the key application GS2 on contemporary HPC architectures, when deploying thousands of compute cores. This improved understanding of GS2 has been utilised to improve performance of the data redistribution routines. A modified data decomposition, allowing for a slight increase in load imbalance, substantially reduced the communication costs of the application and improved the overall performance. This approach may be applicable to many other HPC applications which are deploying spectral methods. The decomposition techniques, which could have an impact in computational science beyond plasma physics, are described in detail in a recent research publication.

The project also contributed to a significant performance boost of a factor larger than four for a test simulation utilising several thousand compute cores, which included GS2's advanced collision operator. The improvements have been committed to the GS2 source and are currently of benefit to all users of the GS2 code family on HPC platforms in the UK and elsewhere. The user community of the GS2 code family includes scientists interested in magnetically confined fusion plasmas as well as astrophysical plasmas. The improved, faster application allows for a more efficient use of HPC resources and a more realistic simulation of micro turbulence in magnetised plasmas. The GS2 code family is open source and free to download. The code improvements are therefore of benefit beyond the original project groups.

The GS2 code, improved under this project, was deployed in one of the linked projects to perform first principles calculations of plasma turbulence. These calculations contributed significantly to the understanding of the basic mechanisms that may be responsible for the formations of localised regions of excellent confinement in a fusion plasma. Predictions from these calculations are currently tested experimentally. An improved understanding of these localised regions may be exploited to improve the performance of magnetic confinement devices and increase the chances of utilising fusion plasmas.</gtr:description><gtr:id>D8ADCC5D-C83C-4732-B6BA-CD4378B66B28</gtr:id><gtr:impactTypes/><gtr:outcomeId>5447ce2228b6b6.41372116</gtr:outcomeId></gtr:impactSummaryOutput></gtr:impactSummaryOutputs><gtr:intellectualPropertyOutputs/><gtr:keyFindingsOutput><gtr:description>The grant EP/H00212X/1 held at the University of Edinburgh, was part of a broader scientific project on the computational modelling of plasma turbulence in magnetised plasmas. The science was largely carried out under the linked grants EP/H002081/1 and EP/H002189/1. As detailed in the original proposal, the role of the project members from EPCC at the University of Edinburgh is to advise the project on the high performance computing (HPC) related aspects of the broader scientific project. This report covers the HPC optimisation work, where the EPCC effort funded under grant EP/H00212X/1 was deeply involved.



EPCC software development effort was concentrated on the applications GS2 and CENTORI, which were utilised for the plasma turbulence simulations carried out under grant EP/H002081/1. GS2 and CENTORI are both parallelised in MPI and highly suitable for exploitation on a modern HPC platform such as the HECToR system. The major application exploiting the HECToR resource to deliver

scientific outcomes under EP/H002081/1 was the GS2 code, which solves gyrokinetic equations self-consistently with Maxwell's equations to model microturbulence in magnetised plasmas. CENTORI is a two-fluid electromagnetic turbulence code, that was recently developed to study magnetically confined fusion plasmas on energy confinement time scales.



The most impressive HPC achievement delivered by this project is a performance enhancement that exceeds a factor of four for running a typical GS2 benchmark on 4096 processors. This resulted from a number of optimisations, which working together have dramatically improved the scalability of GS2 and made the code more suitable for the next generation of HPC platforms, including the UK's forthcoming HPC service Archer.





GS2 work



In this section we provide more details on the work on GS2 during the life time of the project grants. For further detail consult the references and web-links at the end of this summary. 



Early on in the project, indirect addressing was identified as a bottleneck affecting GS2's performance on contemporary hardware, such as the HECToR system [1]. Indirect addressing is deployed in various parts of the source code, including the performance critical data redistribution routines. The use of indirect addressing allows GS2 to be extremely flexible with its data layout. The plasma physicists is free to choose from a number of data layouts that which is most suitable for his/her problem. This project secured additional funding from the HECToR dCSE support program to support the software development effort to tackle this issue.



In collaboration with the developer funded by the HECToR dCSE grant, the project designed, implemented and tested revised data redistribution routines into the GS2 source. These revised routines significantly reduce the use of indirect addressing in the most performance critical parts of the code. The final redistribution routines were committed to the GS2 source repository, and where between 40% and 50% faster than the originals [2], roughly achieving the performance improvement that was anticipated during the initial exploratory work.



During the work on the data redistribution routines, further performance limiting issues in data communications became apparent. The original code aimed for computational load balance between MPI processes, but for some process counts this requirement forced extremely large data transfers that were saturating the communication network. An option was added to GS2, to make a modest sacrifice in computational load balance, that could result in substantially more efficient communications. In particular on large process counts performance improvements as high as 15% were achieved [2, 3]. This interesting optimisation approach may be applicable to many other HPC applications, in particular those using spectral methods to solve non-linear problems. A journal publication on this work is in preparation and an advanced draft is publicly available [3].



In the most recent optimisation work carried out under this project, a variety of performance tools were used to target more advanced physics simulations that include GS2's advanced collision operator, developed by Barnes et al [4]. The optimisation work removed several bottlenecks that were severely hampering the scalability of GS2: (i) reducing unnecessary computational work that was being carried out in expensive initialisation routines; (ii) exploiting sub-communicators to reduce the need for global communications in velocity space integrals associated with the collision operator; and (iii) velocity space integrals in all parts of the program were further improved by introducing in-place MPI communication calls that removed the need for buffer packing. These optimisations are particularly valuable at larger processor counts, and have achieved a speed-up exceeding four for running a typical GS2 benchmark problem on 4096 cores. Further details on this work are available in slides from a recent group meeting [5].





CENTORI work



CENTORI was recently developed. The software development effort provided by EPCC ensured an efficient implementation of the computational engine and the MPI parallelisation of the application [6].





Further information:



[1] Joachim Hein, Xu Guo, &amp;quot;Upgrading the FFTs in GS2&amp;quot;, HECToR dCSE project final report, http://www.hector.ac.uk/cse/distributedcse/reports/GS2/GS2.pdf



[2] Adrian Jackson, &amp;quot;Improved Data Distribution Routines for Gyrokinetic Plasma

Simulations&amp;quot;, HECToR dCSE project final report, http://www.hector.ac.uk/cse/distributedcse/reports/GS202/GS202.pdf



[3] Adrian Jackson, Joachim Hein, Colin M. Roach, &amp;quot;Optimising Performance Through Unbalanced Decompositions&amp;quot;, http://arxiv.org/abs/1205.2509



[4] M. Barnes, I.G. Abel, W. Dorland, D.R. Ernst, G.W. Hammett, P. Ricci, B.N. Rogers, A.A. Schekochihin, and T. Tatsuno, Physics of Plasmas 16, 072107 (2009)



[5] D. Dickinson, C.M. Roach, A. Jackson, J. Hein, &amp;quot;Report on recent upgrades to GS2&amp;quot;, http://gyrokinetics.sourceforge.net/wikifiles/CMR/GS2DEVMEETING_21May2013/DDICKINSON.pdf



[6] P.J. Knight, A. Thyagaraja, T.D. Edwards, J. Hein, M. Romanelli, K.G. McClements, Computer Physics Communications 183 (2012) 2346-2363</gtr:description><gtr:exploitationPathways>The goal of simulating plasma turbulence is to suggest routes to optimise the performance of future plasma confinement devices. Understanding and limiting turbulence is crucial to obtain long confinement times. It is hoped that in the future fusion plasmas can be exploited for energy production in a fusion power plant. The improved computational efficiency of GS2 will result in a reduced consumption of HPC resources. For a given resource level this allows plasma physicists studying micro turbulence to use larger and more realistic models in their simulation of magnetic confined fusion plasmas.</gtr:exploitationPathways><gtr:id>CE611DCE-DDDF-4C90-81EC-2EF1B53F61D2</gtr:id><gtr:outcomeId>r-7143715598.7543277667080</gtr:outcomeId><gtr:sectors><gtr:sector>Digital/Communication/Information Technologies (including Software),Energy,Environment</gtr:sector></gtr:sectors></gtr:keyFindingsOutput><gtr:otherResearchOutputs/><gtr:policyInfluenceOutputs/><gtr:productOutputs/><gtr:researchDatabaseAndModelOutputs/><gtr:researchMaterialOutputs/><gtr:softwareAndTechnicalProductOutputs/><gtr:spinOutOutputs/></gtr:output><gtr:publications><gtr:publication><gtr:id>2B809419-3779-44D1-A33F-2AB94B69BD4B</gtr:id><gtr:title>Optimising Performance through Unbalanced Decompositions</gtr:title><gtr:parentPublicationTitle>IEEE Transactions on Parallel and Distributed Systems</gtr:parentPublicationTitle><gtr:authors><gtr:author url="http://gtr.ukri.org:80/person/4cde5a728a30fccb64991e2d25d7a59d"><gtr:id>4cde5a728a30fccb64991e2d25d7a59d</gtr:id><gtr:otherNames>Jackson A</gtr:otherNames></gtr:author></gtr:authors><gtr:date>2015-01-01</gtr:date><gtr:outcomeId>541862a14fc258.80928871</gtr:outcomeId></gtr:publication><gtr:publication><gtr:id>9BC10810-04BF-4AF8-90AE-F3ABC4BBB2FB</gtr:id><gtr:title>CENTORI: A global toroidal electromagnetic two-fluid plasma turbulence code</gtr:title><gtr:parentPublicationTitle>Computer Physics Communications</gtr:parentPublicationTitle><gtr:authors><gtr:author url="http://gtr.ukri.org:80/person/f75366dbc16e96af03ad2e0613bf883e"><gtr:id>f75366dbc16e96af03ad2e0613bf883e</gtr:id><gtr:otherNames>Knight P</gtr:otherNames></gtr:author></gtr:authors><gtr:date>2012-01-01</gtr:date><gtr:outcomeId>doi_53cfebfeb0954304</gtr:outcomeId></gtr:publication></gtr:publications><gtr:identifiers><gtr:identifier type="RCUK">EP/H00212X/1</gtr:identifier></gtr:identifiers><gtr:healthCategories/><gtr:researchActivities/><gtr:researchSubjects><gtr:researchSubject><gtr:id>8C42F55F-1A1F-4ACE-B264-F6697518680A</gtr:id><gtr:percentage>100</gtr:percentage><gtr:text>Plasma physics</gtr:text></gtr:researchSubject></gtr:researchSubjects><gtr:researchTopics><gtr:researchTopic><gtr:id>5A153F61-85B9-466B-AC56-9B187EFF9AD9</gtr:id><gtr:percentage>100</gtr:percentage><gtr:text>Plasmas - Laser &amp; Fusion</gtr:text></gtr:researchTopic></gtr:researchTopics><gtr:rcukProgrammes/></gtr:project></gtr:projectComposition></gtr:projectOverview>