<?xml version="1.0" encoding="UTF-8"?>
<gtr:projectOverview xmlns:gtr="http://gtr.ukri.org/api"><gtr:projectComposition><gtr:collaborations/><gtr:leadResearchOrganisation url="http://gtr.ukri.org:80/organisation/3A5E126D-C175-4730-9B7B-E6D8CF447F83"><gtr:id>3A5E126D-C175-4730-9B7B-E6D8CF447F83</gtr:id><gtr:name>University College London</gtr:name><gtr:department>Medical Physics and Biomedical Eng</gtr:department><gtr:address><gtr:line1>Gower Street</gtr:line1><gtr:line4>London</gtr:line4><gtr:postCode>WC1E 6BT</gtr:postCode><gtr:region>London</gtr:region><gtr:country>United Kingdom</gtr:country></gtr:address><gtr:typeInd>RO</gtr:typeInd></gtr:leadResearchOrganisation><gtr:organisationRoles><gtr:organisationRole url="http://gtr.ukri.org:80/organisation/3A5E126D-C175-4730-9B7B-E6D8CF447F83"><gtr:id>3A5E126D-C175-4730-9B7B-E6D8CF447F83</gtr:id><gtr:name>University College London</gtr:name><gtr:address><gtr:line1>Gower Street</gtr:line1><gtr:line4>London</gtr:line4><gtr:postCode>WC1E 6BT</gtr:postCode><gtr:region>London</gtr:region><gtr:country>United Kingdom</gtr:country></gtr:address><gtr:roles><gtr:role><gtr:name>LEAD_RO</gtr:name></gtr:role></gtr:roles></gtr:organisationRole></gtr:organisationRoles><gtr:personRoles><gtr:personRole url="http://gtr.ukri.org:80/person/9E6C09E6-578C-4956-96C8-335B7AD5ECFC"><gtr:id>9E6C09E6-578C-4956-96C8-335B7AD5ECFC</gtr:id><gtr:firstName>Julia</gtr:firstName><gtr:otherNames>Anne</gtr:otherNames><gtr:surname>Schnabel</gtr:surname><gtr:roles><gtr:role><gtr:name>RESEARCHER_COI</gtr:name></gtr:role></gtr:roles></gtr:personRole><gtr:personRole url="http://gtr.ukri.org:80/person/635AE715-BD06-467A-8F5F-823DFEDCB5E3"><gtr:id>635AE715-BD06-467A-8F5F-823DFEDCB5E3</gtr:id><gtr:firstName>David</gtr:firstName><gtr:surname>Atkinson</gtr:surname><gtr:roles><gtr:role><gtr:name>PRINCIPAL_INVESTIGATOR</gtr:name></gtr:role></gtr:roles></gtr:personRole></gtr:personRoles><gtr:project url="http://gtr.ukri.org:80/projects?ref=EP%2FF01144X%2F1"><gtr:id>AF174826-2AA9-48E5-A8AB-885289FE73C1</gtr:id><gtr:title>HPC Software for Medical Imaging</gtr:title><gtr:status>Closed</gtr:status><gtr:grantCategory>Research Grant</gtr:grantCategory><gtr:grantReference>EP/F01144X/1</gtr:grantReference><gtr:abstractText>The performance of computers with a single core , i.e. a traditional CPU, is not expected to continue increasing at the same rate as in the past. To boost overall computer performance, manufacturers now provide multi-core processors. For the development of faster software, programmers are going to be forced to make use of multi-core technology. The power of the mass market means that there are now two relatively cheap hardware configurations each with about 100 cores. These are computer clusters where PCs are networked together, and, graphics cards. The performance of graphics cards has recently been outstripping that of CPUs. Graphics cards have the added advantages of being cheap and self-contained.In medical imaging, the alignment or registration of images is an important step in clinical image analysis. In diseases such as Alzheimer's or other forms of dementia, the brain shrinks over an extended period of time. Over shorter time scales these changes are not obvious when looking at two images side-by-side. Registration aligns images by accounting for differences in the patient position and scanner variations. It also provides a measure of local changes in tissue volume. These algorithms take hours to run, longer than the time a patient is in a scanner. If the data processing could be complete with a few minutes, more detailed follow-up scanning could be possible.Registration is also used to combine large numbers of datasets to determine normal and abnormal anatomy. This is often called atlas building. The creation of atlases needs large amounts of memory and this currently limits the number of datasets that can be included. Building an atlas is well suited to a computer cluster. Once created, if an atlas could be registered with a patient's image whilst they were still in the scanner, it could provide information on-the-spot about abnormal anatomy in the patient. Some of the newer Magnetic Resonance Imaging (MRI) techniques such as diffusion weighted imaging and functional MRI provide detailed information about nerve connections in the brain or show up thoughts . The processing of this data requires images to be in alignment, again, if this could be complete in minutes, diagnosis would be enhanced. This proposal aims to develop algorithms using high-level languages for use on graphics cards or computer clusters. Much of the previous work in this area has required specialised knowledge of the hardware and considerable programming skills. By using the newer high-level languages, we will be able to concentrate more on the applications and problems than the details of the hardware and software architecture. This lends itself to high-quality code because it can be read easily by others, checked on other systems and integrates with debugging and visualisation tools.We aim to demonstrate and evaluate registration algorithms in clinical applications that are currently not feasible due to the data processing being too slow or memory-intensive.</gtr:abstractText><gtr:fund><gtr:end>2009-03-31</gtr:end><gtr:funder url="http://gtr.ukri.org:80/organisation/798CB33D-C79E-4578-83F2-72606407192C"><gtr:id>798CB33D-C79E-4578-83F2-72606407192C</gtr:id><gtr:name>EPSRC</gtr:name></gtr:funder><gtr:start>2007-10-01</gtr:start><gtr:type>INCOME_ACTUAL</gtr:type><gtr:valuePounds>173695</gtr:valuePounds></gtr:fund><gtr:output><gtr:artisticAndCreativeProductOutputs/><gtr:collaborationOutputs/><gtr:disseminationOutputs/><gtr:exploitationOutputs/><gtr:furtherFundingOutputs/><gtr:impactSummaryOutputs><gtr:impactSummaryOutput><gtr:description>The methodology for more realistic simulation of biological tissue has been published and related software is now available open source.</gtr:description><gtr:firstYearOfImpact>2011</gtr:firstYearOfImpact><gtr:id>A044EF94-6540-46D1-970D-240B1DF0649B</gtr:id><gtr:impactTypes><gtr:impactType>Policy &amp; public services</gtr:impactType></gtr:impactTypes><gtr:outcomeId>545b7ca5332246.38788457</gtr:outcomeId><gtr:sector>Healthcare</gtr:sector></gtr:impactSummaryOutput></gtr:impactSummaryOutputs><gtr:intellectualPropertyOutputs/><gtr:keyFindingsOutput><gtr:description>An important and developing area is the incorporation into image analysis algorithms of biomechanical models of how
tissues deform. Common example applications include surgical guidance and planning, and, the warping of one image to align it with another (non-rigid registration). In such cases biomechanical models provide a powerful basis for analysing and accounting for the deformation of structures within images. To be clinically useful, however, any approach must yield solutions within a &amp;quot;reasonable&amp;quot; time: intra-operative applications require near real-time solutions; statistical atlas construction involving multiple registrations dictates rapid individual registrations (these atlases capture information from multiple subjects but require anatomic features to be aligned). Biomechanical models are generally computationally intensive, especially in the clinically relevant cases of nonlinear analyses. Consequently, their clinical employment has been limited.


In response to this we have developed methods for accelerating biomechanical computations using graphics processing units (GPUs). Such devices derive very high floating point operation capacities from massively parallel Single Instruction Multiple Data chip architectures. The power of these devices is best harnessed when algorithms are data parallel. Our developments were based on efficient parallelisation of tissue models, rather than any simplification of models.


The most physically consistent biomechanical models are those based on a soft tissue response that varies with time.
Though there have existed mature frameworks for modelling such phenomena (the predominant one being viscoelasticity), they have largely been omitted because of their computational complexity. We developed an efficient
numerical procedure that allows inclusion of viscoelastic models in Finite Element models. We used an &amp;quot;explicit&amp;quot; method that allows the system to be decomposed into parallel loops over the nodes and elements of a Finite Element mesh.


GPU-based implementations of all algorithms were produced using NVidia's CUDA language. In this framework code is divided into a CPU-host component and a GPU-device component. The former comprises regular C/C++ code, while the latter comprises C code augmented by a number of additional types and functions, plus some CUDA-specific execution structures. Being an extension of the C language, CUDA simplifies integration of GPU computation with larger or existing systems.


Results from the GPU-based solver were compared with those of a serial CPU-based implementation developed
concurrently. No precision errors appear to be introduced in the GPU version. Comparison of execution times for meshes
of various sizes shows a peak acceleration of 56.3 times for the GPU implementation. Models with up to 55,000 degrees
of freedom are solvable in real-time, while even large problems of around 1.5M degrees of freedom are solvable in
approx. 42sec, making them viable for intra-operative applications.

The performance of the viscoelastic solution method was assessed by comparison with equivalent elastic models. The
procedure was shown to result in only an approx. 5% increase in computation time. Combined with a Finite Element
framework, the procedure allows use of robust viscoelastic constitutive models in time-critical applications.





Originality: First efficient implementation of anisotropic, visco-elastic tissue models on GPUs. Technique allows realistic
modelling of tissue deformations with time varying material properties including stress dissipation. 



Significance: 
Enables rapid simulation of tissue deformation with applications to interactive surgery simulation and interoperative image registration. Implemented in the SOFA Open Source Framework. With one other paper, forms the principal basis for the Open Source NiftySim software (sourceforge.net/projects/niftysim/) with over 500 downloads since launch. 

Rigour:
Performance evaluated using simulations and data derived from liver images. Extensive measures of algorithm timings
relevant to real-time applications.</gtr:description><gtr:exploitationPathways>The material modelling techniques may be applicable in an industrial context. NiftySim code is available for download:

http://cmic.cs.ucl.ac.uk/home/software/</gtr:exploitationPathways><gtr:id>A5C5872D-3513-4CB0-A0FF-CB126EC54EB7</gtr:id><gtr:outcomeId>r-6776879017.033502776f3bd4</gtr:outcomeId><gtr:sectors><gtr:sector>Healthcare</gtr:sector></gtr:sectors><gtr:url>http://cmic.cs.ucl.ac.uk/home/software/</gtr:url></gtr:keyFindingsOutput><gtr:otherResearchOutputs/><gtr:policyInfluenceOutputs/><gtr:productOutputs/><gtr:researchDatabaseAndModelOutputs/><gtr:researchMaterialOutputs/><gtr:softwareAndTechnicalProductOutputs><gtr:softwareAndTechnicalProductOutput><gtr:description>Nifty Sim is a high-performance nonlinear finite element solver, developed at University College London. A key feature is the option of GPU-based execution, which allows the solver to significantly out-perform equivalent commercial packages.</gtr:description><gtr:id>B5C6A1D8-F93B-4659-AFA6-B2E6165AF798</gtr:id><gtr:impact>Work in this grant contributed to the NiftySim package. This has 1700+ downloads from sourceforge.net</gtr:impact><gtr:outcomeId>545b9cbdcfa075.30110960</gtr:outcomeId><gtr:title>NIftySim</gtr:title><gtr:type>Software</gtr:type><gtr:url>http://niftysim.sourceforge.net/</gtr:url><gtr:yearFirstProvided>2009</gtr:yearFirstProvided></gtr:softwareAndTechnicalProductOutput></gtr:softwareAndTechnicalProductOutputs><gtr:spinOutOutputs/></gtr:output><gtr:publications><gtr:publication><gtr:id>A1E78D0E-4CE3-4EE2-A829-DA7BAA67E37B</gtr:id><gtr:title>Commodity Graphics Cards for Image Registration, Biomechanical Modelling and Cardiac Imaging.</gtr:title><gtr:parentPublicationTitle> Bioengineering 08.</gtr:parentPublicationTitle><gtr:authors><gtr:author url="http://gtr.ukri.org:80/person/e8d154ab1ab2ee47eef2db26be292b89"><gtr:id>e8d154ab1ab2ee47eef2db26be292b89</gtr:id><gtr:otherNames>Atkinson D</gtr:otherNames></gtr:author></gtr:authors><gtr:date>2008-01-01</gtr:date><gtr:outcomeId>m_661261497813f1c760</gtr:outcomeId></gtr:publication><gtr:publication><gtr:id>DD017DFF-BBD9-40A7-AAC8-C6BB57BF7D47</gtr:id><gtr:title>Modelling anisotropic viscoelasticity for real-time soft tissue simulation</gtr:title><gtr:parentPublicationTitle>LNCS</gtr:parentPublicationTitle><gtr:authors><gtr:author url="http://gtr.ukri.org:80/person/82865b697edbe9cb8b8daa3db55a347f"><gtr:id>82865b697edbe9cb8b8daa3db55a347f</gtr:id><gtr:otherNames>Taylor ZN</gtr:otherNames></gtr:author></gtr:authors><gtr:date>2008-01-01</gtr:date><gtr:outcomeId>m_606150575213f399be</gtr:outcomeId></gtr:publication><gtr:publication><gtr:id>5CC2A4D0-C9D2-451D-BB79-C3436CE0CA85</gtr:id><gtr:title>On modelling of anisotropic viscoelasticity for soft tissue simulation: numerical solution and GPU execution.</gtr:title><gtr:parentPublicationTitle>Medical image analysis</gtr:parentPublicationTitle><gtr:authors><gtr:author url="http://gtr.ukri.org:80/person/7cdc3ba611fad1a130ac2be370a0cbd0"><gtr:id>7cdc3ba611fad1a130ac2be370a0cbd0</gtr:id><gtr:otherNames>Taylor ZA</gtr:otherNames></gtr:author></gtr:authors><gtr:date>2009-01-01</gtr:date><gtr:issn>1361-8415</gtr:issn><gtr:outcomeId>54353c418c1df7.27758732</gtr:outcomeId></gtr:publication></gtr:publications><gtr:identifiers><gtr:identifier type="RCUK">EP/F01144X/1</gtr:identifier></gtr:identifiers><gtr:healthCategories/><gtr:researchActivities/><gtr:researchSubjects><gtr:researchSubject><gtr:id>6723A70B-A523-40AB-9740-B6AD2A0677B7</gtr:id><gtr:percentage>50</gtr:percentage><gtr:text>Medical &amp; health interface</gtr:text></gtr:researchSubject><gtr:researchSubject><gtr:id>FB535BD0-E265-4C0A-8532-32DCB83A3951</gtr:id><gtr:percentage>50</gtr:percentage><gtr:text>Tools, technologies &amp; methods</gtr:text></gtr:researchSubject></gtr:researchSubjects><gtr:researchTopics><gtr:researchTopic><gtr:id>9EAAD5EA-2E54-4986-942F-2E204958FE29</gtr:id><gtr:percentage>50</gtr:percentage><gtr:text>High Performance Computing</gtr:text></gtr:researchTopic><gtr:researchTopic><gtr:id>E48C802F-8897-4353-910A-09D09331BB82</gtr:id><gtr:percentage>50</gtr:percentage><gtr:text>Medical science &amp; disease</gtr:text></gtr:researchTopic></gtr:researchTopics><gtr:rcukProgrammes/></gtr:project></gtr:projectComposition></gtr:projectOverview>